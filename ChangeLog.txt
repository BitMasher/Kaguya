Welcome to the Kaguya ChangeLog.


Changelog:

Version 1.26.2

- $profile's "Total Currency Awarded" is now accurately updated through gamble wins.
- Active Kaguya supporters have a more lenient rate limit of 5 commands every 4.25 seconds.
- Users must now verify that they are 18 years old before they may view Kaguya's NSFW content.
    - Verification is achieved by replying with "I confirm." when prompted.
    - Verification only happens once. Once the user is verified, they will never have to verify again.
- Kaguya is now on 2 shards.

Version 1.26.1

- The ratelimit has been adjusted to 3 commands every 4.25 seconds (was 5 seconds).
- Performance/stability increases (account data is now saved every 5 seconds instead of multiple times per second).
- If a user has previously been ratelimited, but does not exceed the rate limit for thirty days,
    their ratelimit strikes will be reset.

Version 1.26

- This update features a long awaited feature: The Kaguya Ratelimit!
    - Kaguya now has a global command rate limit of 3 commands every 5 seconds. Anything in
    excess will result in a "ratelimit strike".
    - Upon receiving a ratelimit strike, Kaguya will DM you letting you know that you are
    abusing the ratelimit and have been temporarily blacklisted from the bot.
    - The ratelimit strikes each have an increasingly long blacklist duration, depending on 
    how many strikes you have.
        - First strike: 60 seconds
        - Second strike: 10 minutes
        - Third strike: 60 minutes
        - Fourth strike: 12 hours
        - Fifth strike: Permanent (900,000 days), points and EXP reset to zero.
    - The ratelimit applies to all commands globally.
- osu! beatmap linkage now no longer works if the user's account is blacklisted.
- osu! beatmap linkage is now treated as a command and will apply to the ratelimit.

Version 1.25.1

- Gambling stats are now logged in the console.
- Released a hotfix that fixed a bug where $n bomb would not work most of the time.
    - This reverts the feature where a user is prompted to spend their diamonds
    to reset their $n bomb cooldown if they have enough points.

Version 1.25

- If a user runs out of "$n bomb" uses for the hour, it will now display this in the console.
- Whenever a shard is connected, it will now be announced in a kaguya support text channel.
- Gambling bad luck prevention added: after 5 rolls, if a user still hasn't won, foreach roll before and thereafter,
    the roll's "luck" increases by 2%. If I roll 7 losses in a row, my next roll will have a 16% increased chance of 
    winning.
- Similarly, if a user has more than 15 rolls and has more than a 45% winrate, they will have a 5% **decreased** 
    chance of winning on all rolls until their winrate returns to something below 45%. 
    This is not influenced by bad luck prevention.
- Fixed a bot-breaking bug where a corrupted file resulted in the bot not working.
    This file is the servermessagelogs cache file which stores the most 500 recent messages for all guilds.
    If the bot had to suddenly close, the overwriting of the file would sometimes be corrupted. When the bot
    attempted to launch next, it would fail to load the file and the bot would freeze.
    Now, Kaguya will know whether or not the file is corrupted on launch, and if it is, it will delete the cache and
    create a new one. This will result in significant long-term stability improvements. This file is now impossible to break.
- New stat tracking:
    - TotalCurrencyGambled
    - TotalCurrencyAwarded
    - TotalCurrencyLost
    - RatelimitStrikes
    - (10 most) RecentlyUsedCommands
    - GamblingBadLuckStreak
    - Gambling history
- The seconds portion of the "join date" section of the $osu command has been removed.
- $history command added: allows any user to see their 10 most recent Kaguya gambles and their details.
- $profile now shows many more stats, including your EXP rank in the Kaguya database!
- Fixed a bug with the music player where, when skipping a song, Kaguya would unexpectedly exit from the voice channel.
- Added $m join so that you can connect the bot to the voice channel before requesting music. (If this doesn't work,
    use $m leave to stop the active player, then $m join/$m play again.)
- A new function for diamonds has been added: If you run out of $n bomb uses for the hour, while not being a supporter 
    but have more than 50 diamonds in your account, you will be prompted on whether or not you would like to spend
    50 of your diamonds to reset the cooldown. This can be done as many times as you want until you have less than
    50 diamonds. If you do not react with a check mark, you will be reminded that you can upvote Kaguya on DBL to reset
    your cooldown.

Version 1.24

- $repauthor no longer embeds with a red color on a successful use. (It's now pink)
- Custom command prefixes are no longer case sensitive.
- When a user successfully redeems a supporter tag, they are now DM'd and Stage is sent a notification through DM as well.
- When a new game of tic tac toe is started, the blank play area is now shown.
- Fixed a bug with the anti-raid service where it would unexpectedly punish users.
- Fixed a bug that prevented users who successfully used $voteclaim from having their $n bomb cooldown reset.
- When a user's Kaguya supporter tag expires, their role is removed and the user is DM'd.

Version 1.23

- $antiraid command added. Features an interactive setup for a very powerful anti-raid service.
- $antiraidoff command added.
- $massban command largely improved. Now, instead of breaking the ban cycle when it runs into an error, it will continue.
    - Errors include things like deleted accounts or if Kaguya's role is not at the top of the hierarchy.
    - Made the same types of improvements to $masskick
- Users may no longer earn EXP in blacklisted servers.
- Massblacklist no longer requires the bot owner to also have administrator when using it.
- Totally fixed $massblacklist. Now takes in a list of IDs instead of a list of guild users.
    - This means blacklists don't have to be of people that are in the same server you execute the command from.
- Unused $antiraid (owner only) command removed.
- If the music player has finished playing, with no more songs in the queue, it will now automatically disconnect. (Same for music errors.)
- $autoassign [aa] command added.
- $autoassignremove [aar] command added.
- $autoassignclear [aac] command added.
- $autoassignview [aav] command added.
- Improved music service exception message. It's now less generic/vague.
- Fixed a bug with the music player where Kaguya could not play copyrighted songs.
- $serverblacklist [sbl] owner only command added.
- $serverunblacklist [subl] owner only command added.
- $massblacklist renamed to $userblacklist
    - Alias added: $ubl
- $reloadconfig has been tested and works! This allows for file modification without the need to restart the bot.
- Completely removed all NSFW tags except for $n, $n bomb, and $n gif.
    - I will focus on improving these for now. It is simply way too time consuming to manually create tags for thousands of images.
    - They have been removed from the command list.
- Fixed a bug where timers (such as updating the game, backing up files, etc) would overlap each other if a shard disconnected, then reconnected.
    - Now, there will only be one timer (per shard).
- New "game" added to the rotation: Kaguya's current version!
- Fixed a bug where $expadd <num> <user> would mention the user of the command, not the recipient
- Fixed the same bug with $points <target> and $exp <target>
- $kaguyawarn now has a syntax in the help command

Version 1.22.1

- Added help command for $ping.

Version 1.22

- Fixed a bug with $stats where if a shard disconnected and re-logged in, it would re-add the stats for that shard to the total counts.
    - Now, this will only apply for the first 30 minutes (if this is too long, I will make it shorter, but usually shards don't disconnect within this time frame.)
- $echo will now no longer execute the command if a filtered phrase is detected.
- $ping command added.
- Fully functional tictactoe game added! Check out "$h ttt" or "$h tictactoe" for more info!
- Removed the Global Avg Gamble Win % stat from $stats
- Added a [Owner Only] tag to all bot commands that require owner (in the $help command).
- Added lot of missing commands to the $help command list
- Added a lot of missing $h <command> help commands.
- $scrapeserver removed from the command list. This was owner only but it was useless and was removed awhile ago.
- Alphabetized all of the command lists. (Except for Music, because $m play is the most important one, for example.)
- $createteamrole command removed.
- $delteams command removed from the command list. This is because it's only designed for one server. It is still active, but is now owner only.
- Added missing aliases to various help commands.
- Added missing aliases to various missing commands in the $h command list.
- Added missing permissions to some help commands (Ex: Permissions Required: ...)
- Fixed wrong help command for $removerole


Version 1.21.2

- $n bomb command limited to five uses per hour (was ten).
    - This is to prevent gateway deadlocking (where the bot crashes basically).
    - (If someone wants to spam this five times in succession, nothing will happen anymore. Ten would deadlock the bot.)
- $stats command finalized
- Administrators now automatically override any channel whitelists/blacklists.

Version 1.21.1

- $m join command removed from command list.
- $stats command created (needs to be worked on)

Version 1.21

- Fixed a bug where songs queued in the music player would not skip to the next song when finished.
- All NSFW images are now guaranteed to be compliant with Discord's Terms of Service.
- All NSFW tags have been temporarily disabled as a result, except for ($n, $n bomb, and $n gif).
- NSFW collection significantly improved. Higher quality images, and only the best of the best stuff.
- NSFW images no longer come with an embedded message, they are sent as individual files.

Version 1.20

- Fixed a typo in the help command of $cwl
- Fixed an issue where some commands were being logged twice in the console.
- Removed a few unused user account variables
- Removed the "VerifyUsers" timer.
- Removed a few other poor/unused timers.
- IsBlacklisted is now a boolean, not an integer.
- KaguyaDiamonds has been renamed to Diamonds in UserAccount.cs (Line 12)
- When kicking a user (without a reason), the kicker's username will now properly be displayed.
- Command execution time should be at least slightly improved.
- ConsoleCommandLog.CreateCommandResponse no longer logs to the console, resulting in no more duplicate command logs.
- The "servicing x guilds" count is now separated with a comma if over 1,000 guilds.
- Resources folder is now backed up every 5 minutes (was 15). Logs are now backed up as well.
- $voteclaim should now be able to more accurately detect whether you have voted or not.
- New timer for the Discorbots.org API ratelimit. If there are 50 $voteclaim attempts within 75 seconds, the bot will not execute that function until the appropriate time has passed.
    - This ensures we don't get blocked by them!
- $n bomb usage is now limited to 10 per hour. You may reset this cooldown once every 12 hours with $voteclaim.
    - Kaguya supporters have no cooldown on $n bomb (This was implemented because the command is very resource intensive).
- $diamondconvert/$dc command added. If you have diamonds in your account ($diamonds), you may convert them to points! 1 diamond is worth 100 points.
- Critical hit chances have been significantly reduced.
    - Timely points:
        - No vote, no supporter: 6% (was 12%)
        - No vote with supporter (or vice versa): 12% (was 28%)
        - Vote and Supporter: 24% (was 56%)
    - Gambling:
        - No vote, no supporter: 5% (was 8%)
        - No vote with supporter (or vice versa): 10% (was 16%)
        - Vote and supporter: 20% (was 32%)
    - Weekly points:
        - No vote, no supporter: 8% (same as before)
        - No vote with supporter (or vice versa): 12% (was 16%)
        - Vote and supporter: 24% (was 32%)

Version 1.19.6

- All support server invite links have been replaced with a current one.


Version 1.19.5

- Scrapeserver and Scrapedatabase commands removed (owner only, but they were useless.)
- Adds $antiraid command, bot owner only. Very basic, and is pretty much untested.


Version 1.19.4

- $warn/$w now allows moderators to add a reason for their mute. Syntax: $m <user> [reason]
    - If no reason is specified, the user will be DM'd with "No reason specified".
    - If there is a reason, the user will be DM'd with the reason.

Version 1.19.3

- $fact command added. Displays a random fact in chat!
- channel white/blacklist commands added to help command.
- Help commands for all channel whitelisting/blacklisting commands have been added.

Version 1.19.2

- $channelwhitelist [cwl] command added, this allows server administrators to make Kaguya only work in a certain set of channels.
- $channelblacklist [cbl] command added, this allows server administrators to block Kaguya from responding in a certain set of channels.
- $whitelist and $blacklist commands added, these allow server administrators to see what channels are currently whitelisted/blacklisted respectively.
    - You can think of this as a "viewwhitelist" / "viewblacklist" command.
- NOTE: Setting the whitelist will clear the blacklist, and setting the blacklist will clear the whitelist!

Version 1.19.1

- Fixed a bug where commands were not logged to the console.
- Fixed a bug where commands that were logged had the wrong execution time.

Version 1.19

- Code modification, color for all embeds defaults to pink (you no longer have to specify it in the code). (Thank you to "CakeAndBanana" for contributing this change)
- "$warnpunishments" command added. This allows server administrators to see their warning punishment configuration.- "$warn" now has an alias of "$w"
- "$warn" now has an alias of "$w"
- "$warnoptions" now has an alias of "$wo"
- "$warnset" now has an alias of "$ws"
- "$m join" command removed. Use $m play for Kaguya to auto-join.
- "$assignrole" command added. Use this command to assign a role to a list of users. This command has an alias of "$ar".
- "$removerole" command added. Use this command to remove a role from a list of users. This command has an alias of "$rr".
- "$invite" command added. Use this command to receive a DM of an invite link and a link you can use to add Kaguya to your server.
- "$sync" command added for Kaguya Supporters. After redeeming your supporter key, use the $sync command in the support server to automatically have your supporter role applied to you!

Version 1.18

- Successful and failed commands are now logged in a file (stored locally).
- Kaguya is now sharded. This means she can support tens of thousands of servers!
- Cleaned up a ton of code in Program.cs and CommandHandler.cs (two most important files in the whole system.)
- Updated 10+ Discord related packages for Kaguya.
- Logging cmds moved from Administration.cs to LoggingCommands.cs in the Administration folder.

Version 1.17.1

- Forgot to add $m jump to the help command ^_^'

Version 1.17

- Fixed a bug where the music player could not load songs.
- Fixed a bug where the music player could not skip songs.
- Fixed a bug where the music player would die instead of not load a song longer than 10 minutes.
- Replies to music related funcitons have been improved.
- Music volume has been allowed to go from 0-200 (was 1-149).
- "$m jump" command added. You may now jump to a spot in the queue!
- Fixed a typo in the $m help command that was confusing. It had $p in there instead.


Version 1.16.4

- $p and $profile now have help commands.
- $points help command updated (it had the Title as part of the description too).

Version 1.16.3

- $profile command added. See all of your Kaguya stats at once! Alias: "$p"

Version 1.16.2

- Kaguya will no longer reply to invalid commands. They will instead fail silently.
- EXP leveling formula adjusted from (Square Root(EXP / 27)) --> (Square Root(EXP / 8)).
    - This results in requiring significantly less EXP to level up, but this change was primarily put in place
       because the gaps between levels were becoming too large too soon. For example, the difference between levels
       33 and 27 was over 10,000 EXP (roughly 900 messages with a 110-130 second cooldown between them.)
    - Level 33 should now be around level 61 (~30,000 EXP),
    - Level 27 should now be around level 49 (~20,000 EXP), 
    - Level 35 is now ~10,000 EXP.
    - Level 24 is now ~5,000 EXP.
    - Level 10 is now ~1,000 EXP.
    - Level 1 is now ~80 EXP.
    - The rate of earning EXP has been changed from (7-11 every 110-130 seconds --> 5-8 every 110-130 seconds).
        - Please give feedback on what you think about this EXP change!
- Global Kaguya Warnings added. This is for me (or any future Kaguya Administrators) to $kaguyawarn someone. After 3
    global warnings, the user will be blacklisted from Kaguya. They will be DM'd with why they received the warning, and 
    will be told how many warnings they have. Upon receiving a blacklist from warnings, they will have their points, rep,
    and EXP set to zero. These warnings are primarily sent to users seen abusing Kaguya, abusing the $bug report feature,
    or is exploiting the bot in some other way.
    - This command won't be listed in the command list.


Version 1.16.1

- Small hotfix for the console logger (it was getting really flooded).

Version 1.16

- $ban may now include a reason. This reason is sent to the log channel for banned users, if there is one.
    - This feature will come for other logtypes soon.
- Logtype "Shadowbans" added! You may now log to a specific channel for shadowban events.
- Logtype "Unshadowbans" added.
- "Violet" color has been darkened for some log events.
- Logtype "UserIsBanned" has been renamed to "bans".
- Logtype "UserIsUnbanned" has been renamed to "unbans".
- Fixed a bug where the ServerMessageLog file would get corrupted, resulting in the messageupdated and messagedeleted logtypes being rendered useless.
- A timer that was supposed to start on Ready never would launch. That is now fixed.
- "Verify message received" now only occurs every 2 minutes (was 1).

Version 1.15.1

- $h redeem command added.
- $h diamonds command added.
- $h supporter command added.
- $supporter and $diamonds commands added.

Version 1.15

- Kaguya Supporter!
    - With the supporter program, users may purchase "keys" that can be redeemed in chat!
    - These keys are one time use, so it is safe to use them in a public chat.
    - This is NOT a recurring subscription!
    - These keys grant you "supporter" status for 30, 60, or 90 days.
    - The keys stack, so if you wish to purchase multiple keys you may! You may also give them away if you wish.
- What does a supporter get?
    - Supporters get a few small perks.
    - Supporters get a stackable 2x critical hit ratio (stacks with the 2x $voteclaim bonus)
    - Supporters have no "gamble limit" (it's 25,000 for normal users).
    - Supporters get a special "supporter" Discord role. (Not automated right now, but it will be soon. I'll do it manually until then.)
    - Supporters receive 600 "Kaguya Diamonds" per month of their supporter.
        - Kaguya Diamonds are a premium currency that are non-transferrable and cannot be gambled.
        - I will come up with a use for these sooner than later.
    - As a supporter, you get the snuggly feeling that comes with knowing you're helping keep Kaguya online.
    - More perks are coming in the future!
- Where can I purchase the keys?
    - All keys can be purchased directly through https://stageosu.selly.store/. This is the ONLY place you can buy keys!
    - Keys may be purchased through PayPal. You may also use Bitcoin and Ethereum.
    - More information on the perks can be found on that page!
- Kaguya's Key System has some rules too:
    - ANY USER CAUGHT PHISHING OR SCAMMING PEOPLE BY ATTEMPTING TO RE-SELL THEIR KEY WILL BE BLACKLISTED FROM KAGUYA.
    - ANY USER WHO FILES A FALSE CHARGEBACK CLAIM WILL BE BLACKLISTED AND WILL BE REPORTED TO THE PROPER AUTHORITIES.
    - DO NOT RESELL YOUR KEY.
    - DO NOT TRUST ANYONE WHO OFFERS THEIR KEY(S) TO YOU AT A LOWER PRICE. DO NOT BUY FROM THEM!!
    - I, STAGE#0001 WITH ID 146092837723832320, AM THE ONLY ONE WHO CAN CREATE AUTHORIZED KEYS. I WILL NEVER DM YOU WITH A KEY, EVER!
    - ANYONE WHO ATTEMPTS TO PRETEND TO BE ME SHOULD BE REPORTED TO DISCORD DIRECTLY AT https://support.discordapp.com/hc/en-us/requests/new?ticket_form_id=360000029731
- Some minor bug fixes. 
- I hope you guys enjoy this feature! Remember, it is ENTIRELY optional. It's simply a way for users to financially support the Kaguya project. xoxo ily all <3


Version 1.14.2

- Fixed a major bug with $warn where it would not execute the proper warn action.

Version 1.14.1

- Added the warn, warnset, and warnoptions commands to the help command (I forgot)!

Version 1.14

- New logtype: "LevelAnnouncements". Server admins may now specify a specific channel to send level up announcements in!
    - Note: The logtype "LevelAnnouncements" will only work if level up announcements are enabled for your server. Check with $toggleannouncements!
- Title of "$rlog" embeds now says "Log channel reset" instead of "log channel set"
- "Currently Playing" game will now rotate every 5 minutes instead of 10.
- Updated the help command for "filteradd" to show how Kaguya's wildcard filter works.
- Help command for $roll is now up to date.
- Help command for $kaguyaexit is now up to date.
- Fixed a bug where if you got a non-critical 100 roll it would say you've won a critical anyway.
- The music player will now no longer play songs longer than 10 minutes.
- Fixed a typo where with "$h hdm", the help command said that the Administrator permission was needed to use the command (when you don't need it).
- Fixed a typo with $kick where the "kicker"'s ID was shown instead of their username.
- Added a new command: warn - Allows any user with the "Kick Users" permission to warn a user. If a user has too many warnings, a punishment will trigger (this is configurable through warnset).
- Added a new command: warnset - Configures the server's warning punishments.
- Added a new command: warnoptions - Allows administrators to see the available warning punishments for users.

Version 1.13.1

- $ban now has the ability to take in more than one word as the "ban reason" ($b <USER> <this can be a long reason now>)
- Updated the help command for $toggleannouncements
- Updated the "On new server join 

Version 1.13

- Removed a 3 second delay I had with $clear that was there for no reason...clearing of messages should happen a lot faster now.
- "MessageEdits" logtype has been renamed to "UpdatedMessages"
- Made a minor update to the $h critical command.
- For all "Emotion" related commands, if you mention a user it will now display their username instead of <@USERID>

Version 1.12.1

- Removed $cmds and $mdls from help command (this was causing a LOT of confusion srryy!!!!)

Verison 1.12

- $osutop -n extension added. You can use this command to target a specific top play and see stats on it. Ex: "$osutop -n 65"
- Added $toggleannouncements to the utility module
- Added a help command for $toggleannouncements
- Fixed a small formatting issue with $h (mute wasn't separated)
- $help has been completely re-written. You can now scroll through the command list with emojis (reactions) and the format is different. Try it out!
- $commands and $modules have been removed as they have basically been merged into the $h command.

Version 1.11.1

- Fixed a bug where $echo wasn't working.
- $echo no longer has a title in the embed.

Version 1.11

- $n command has been given a new dedicated source of lewds. 110 new drawings (however featuring similar characters) have been added!
    - This is exclusive for $n on its own, and does not affect any tags or $n bomb.
- Fixed a bug where it was impossible to get a "100" roll with $gr
- Fixed a small typo with $h bugaward
- $osutop will now show accurate star ratings for songs that are modded (Double Time, HR, EZ, etc.).
- $osutop will now show the player's country flag in the top left.
- $osu will now show how many minutes it's been since you've signed up (in addition to hours, days, and seconds).
- Cleaned up some code in osuGeneral.cs
- $gr multipliers have been slightly reduced.
- critical multiplier for a 100 roll has been set to 5.00 * 6.00 (30x)
- New $inrole command created. This command allows you to type the name of a role and get a list of users who are in that role. Currently, this is limited to 70 members.
    - New feature: Paginated lists! Starting with $inrole, you can now use reactions to scroll through certain command lists.
        - I plan to add this in with help commands soon!


Version 1.10.2

- Removed the server message log verifications because it was super buggy.

Version 1.10.1

- Removed (secret) sttreflog command (it is no longer needed).
- Music commands prefix is now "m" (was "p"). Mute no longer has an alias of "m".
- $m skip responses edited.
- Modified EmbedHandler ~ Can now have a footer as an optional parameter, allowing much easier addition of footers.
    - Saves code space too this way ^_^
- Automatic Bug Report feature added. If an exception is thrown in code, sometimes an automatic bug report will be created if it is important. This allows
    me to fix things without a user having to report the bug.
- If an unknown exception is thrown with the leveling system, it will now be sent in chat and an automatic bug report will be created.
- Cleaned up some code regarding embed message sending.
- ConsoleCriticalAdvisories will now also display the stack trace of the exception that occurred.
- Some error messages that did not appear with a title now will. (18 errors!)
- Attempted to fix a bug where the music player will throw an error if it can't load a query that isn't there. (null request)
- If a song fails to load, Kaguya will now throw an error in chat.
- Fixed a bug with $m resume where it would actually attempt to keep pausing even if it was paused instead of resume.
- Added in-code documentation for EmbedHandler (function summaries, etc.)
- Removed a lot of unnecessary "usings" from several different classes.
- Fixed a bug where the $m queue would display the "Up Next" song in the queue as #2 and #3.
- Fixed a small bug with $m skip where if there was only one song in the queue it wouldn't skip it. Now, it stops and only throws an error if there are no songs in the queue at all.
- Fixed a bug where, on every sent message, the bot was CONSTANTLY overwriting a user's username in the UserAccounts file. Should significantly improve performance.
- Level-ups now will occur slightly more frequently. The xp:level curve was (and may still be) too harsh. All levels will automatically be updated.
- On startup, Kaguya will now verify all server message logs. If she's not connected to a guild that has a log, she will now delete that log. In addition,
    she will now update the server names of all servers in the log.
- Cleaned up a lot of code and removed ~10 unused variables.
- Removed RedCell diagnostic thing in properties because I removed it a long time ago and it kept a really annoying warning hanging around.

Version 1.10

- Music service added (LET'S GOOOO)
    - Enjoy Kaguya's high quality music in your server starting today! Check out all of her new music commands below
- "Music" module added!
    - "p" command group added:
    - $p play: Search YouTube for your favorite song and Kaguya will play your result!
    - $p join: Joins your voice channel!
    - $p pause
    - $p resume
    - $p leave: Leaves current voice channel.
    - $p queue
    - $p skip
    - $p volume
- NOTE: THE MUSIC FEATURE MIGHT BE A LITTLE BUGGY! PLEASE REPORT BUGS WITH $bug !!
- Kaguya will now properly update the server count on discordbots.org



Version 1.9.4

- Removed $sttrefhelper, $delteams, and $createteamrole from the command list. They are still commands that work, but they are in secret owo
- Made an error message more descriptive in the console (Leveling messages not being able to be sent). With this I will hopefully be able to fix this more easily.
- $clear/$purge has been reverted to clear messages much faster than before (rate limit issues).
- $baka, $nekoavatar, $smug, $waifu, and $wallpaper commands added!
- Fixed a bug where $fa wasn't working

Version 1.9.3

- $slap (and all similar commands) no longer require a user, it can be any text!
- $hug, kiss, tickle, poke, and pat commands have been added :)

Version 1.9.2

- The "owner greet DM" for lack of better word has been tweaked.
- Clear will delete each message individually, reducing the chance of the deleted message staying cached on the discord user's screen.
- When Kaguya leaves the server, the server's message log will now be deleted.
- Kaguya's folder structure has been renamed, same with the .exe
- Fixed a bug with $mute where it wouldn't send a response in chat if used without a time.

Version 1.9.1 (Bug fixes)

- Mute command added to $h command.
- Added help commands for modules, mdls, createrole, and cr
- Commands help command is now pink, as it should be.
- kaguyaexit command will now send a response in chat.
- Updated quite a few help commands to be more consistent with the others.
- Fixed a bug with $timely where it would display the wrong remaining time to receive more points.
- $rar will now display the number of roles removed from the user.
- If a role cannot be removed with $rar, Kaguya will now display what happened in chat. The execution of the command will still 
    occur, and all possibly removable roles will be removed.
- $awardeveryone user count is now accurate (was off by one.)
- $masspointsdistribute error embeds are now red (was grey).
- Tweaked formatting of $exp response.
- $exp may now also check the EXP of other users ($exp <user>)
- Links sent in $hdm no longer embed.
- $createtextchannel, $createvoicechannel, $deletetextchannel now all have "Titles" with their embeds (to match $deletevoicechannel)
- $createvoicechannel had two syntax's in the help command, I removed the duplicate.
- shadowban and unshadowban have been added in the help command.
- $slap has been implemented.
- $weekly added to $cmds currency


Version 1.9.0

- $bugaward now properly displays a message in chat.
- There was an issue where the bot was logging an indefinite amount of messages for servers (it stopped at 75k in one server...)
    This has been fixed, and the bot will only log up to 500 messages for each server (I will delete the message cache so everyone will start fresh).
    This will also fix all issues with message logging.
- Added in checks for $ban and $massban - a user may not attempt to ban themselves or the server owner (same with the kick commands).
- Added console log message for $kaguyaexit command.
- Added in console command exception handling if it fails to retrieve information from the DBL API.
- $dr (DeleteRole) will now delete roles even if your capitalization doesn't match the role's capitalization.
- Fixed a bug with $masskick where it would ban the users instead of kick them.
- $masskick and $massban now reply with embeds instead of normal replies (looks prettier).
- Wording of some command responses has been updated.
- Resources folder (user accounts, servers, message logs, etc.) will be saved to the desktop every 15 minutes. No manual backups ever needed again :D
- Patched a loophole that allowed echoed messages with filtered phrases in them to pass through and be sent. Now, the bot will delete both the message and the echoed message immediately.
- Added the $mute command! This is a very, very powerful mute command. Use $h mute for more information!
- Fixed a bug with $addpoints ~ the user would be mentioned not the target.

Version 1.8.5

- Updated link with $vote to directly take you to the bot's vote page.
- Added $rep command (with no parameters, you can now view your own rep).

Version 1.8.4

- toggleannouncements was "toggleannouncements1" in the code...?? That has been fixed.
- Fixed a major bug with $weekly (it basically didn't work).
- Removed unnecessary new instance of Context inside of the MessageCache (could slightly improve stability/performance)
- Kaguya will no longer cache messages from bots! Closes #39
- Updated help command for $pointsadd
- Command prefix size has been increased from a maximum of 2 characters to a maximum of 3.
- $vote and $voteclaim are now embedded with pink (as they should be)
- $restart command added (owner only).
- $kill command added (owner only). Orders the application to exit immediately.

Version 1.8.3

- Users can now use the $vote and $voteclaim commands to earn rewards for upvoting Kaguya on discordbots.org
- Command error footer has been altered, it was misleading.
- Added in help commands for $vote, $voteclaim, and added a new help command for critical hits ($h critical).

Version 1.8.2.1

- $bug added \:D/ - Use this to report bugs!!

Version 1.8.2

- $n may now be used by itself for a random 2D NSFW image.
- $n bomb command added - "Bombs" the channel with 5 different NSFW images.
- Now, only the last 500 messages are logged in a guild (for $log).

Version 1.8.1

- Kaguya will now automatically remove cached messages after two weeks.
- Kaguya's guild count and member count are now accurate.

Version 1.8.0

- Servers that do not allow Kaguya the proper ability to view/write in text channels will be automatically blacklisted (necessary for stability).
- Kaguya now does not flood the logs with channel permission overwrite updates.
- If Kaguya doesn't see a message for one minute, the bot will restart.
- Patreon stuff? owo
- Shadowban command added. Denys a user all channel permissions in the server this command was used in.
- Unshadowban command added.
- Fixed a bug with $toggleannouncements - the "re-enabled" message was written as disabled.
- $expadd can now take away exp as well.
- $expadd can now target users.
- Hentai update - a large list of hentai commands have been added.
    - $n <lewd, boobs, anal, bdsm, bj, classic, cum, feet, eroyuri, pussy, solo, hentai, avatar, trap, yuri, gif>
- Fixed some console logging stuff.


Version 1.7.6

- Removed footer from $osuset (because it already checks to see if your username is valid).
- Added in more specific command error responses
- Fixed a bug where the bot would not error if the requested osutop plays was not between 1 and 10. 
- Tweaked "Playing" text to be smaller.
- Fixed a bug with $recent that would display the wrong map completion %.

Version 1.7.5

- Roll multipliers have been raised, they were previously unfair.
- Critical hit multipliers have been reduced to 2.5 the multiplier of the winning roll (was 3.5);
- Refactored a bit of code (stability)
- Massive stability improvements. Timers are now used for various events that would be triggered by other means (such as users sending messages)
- Massive amounts of unhandled exceptions...handled!
- If a server is set up in a way that prevents kaguya from configuring her text channel permissions, the server owner will be DM'd and the server itself will be blacklisted.
- Added server blacklisted boolean to Servers database file.
- Kaguya's played game will now rotate between 3 helpful messages, one every 10 minutes!
- If a guild returns null in the database (Kaguya is kicked from it), the information/list for that guild will be deleted (log settings, etc).
- Kaguya will now write error messages in chat if the command attempting to be executed does not exist (or if it's missing required parameters).

Version 1.7.4

- Awaited over 200 things that...weren't awaited. Should improve stability! :P
- Cleaned up a lot more code.
- Further developed console logging
- Removed critical losses
- Critical hits now have an 8% chance to occur with winning rolls.
- Fixed a major bug where the bot would crash upon joining a new server. Closes #33
- Updated logger to also show when bot is connected to a new guild/disconencted from a guild.
- Fixed various unhandled runtime exceptions \:D/ for stability!
- Added timer for "Game" name rotation (rotates through statuses every 10 minutes)


Version 1.7.3

- Fixed a bug where the bot would be handling TONS of exceptions (because I set something up wrong), drastically reducing performance.
    This *should* heavily improve bot stability!
- Fixed a bug where $scrapedatabase would crash the bot.
- Fixed a grammatical error with Kaguya's HelpDM message.
- Removed restart timer
- Massive addition: Full fledged custom logging for all commands.
- General code refinement
- Lots and lots of error responses added in. This is to help users understand why a command may not have worked.

Version 1.7.2

- Fixed a typo in Help.cs
- Removed days counter from $recent
- Massive improvements to $recent - Adding in new formatting, "FC %", and "PP for FC with same acc"
- Tweaked $hdm to remove line about self hosting
- pp in $osu now rounds to two decimals
- $timely rolls can now have a 14% chance of being a "critical" hit, awarding 3.50x the normal bonus.
- $roll bets now have a 4% chance of being a "critical hit", awarding 3.50x the multiplier of the winning roll.
    - The highest possible award is a bet of 25,000 multiplied by 17.5x, if you roll a perfect 100 AND crit.
        The odds of this are 1/2,500, or 0.04% (This would award 437,500 points)
- $roll bets also have a 4% chance of being a critical loss, resulting in an additional 25% lost points.
- New $weekly command added - get 5000 points every week! This command also has an 8% chance of being a critical.
- Updated help command for $timely
- Updated help command for "roll" ("gr")
- Fixed other stuff in help cmds
- Got rid of some useless code
- $8ball command added for fun


Version 1.7.1

- Added in star rating for the osu! beatmap link parser.
- CS, AR, OD, and HP values in the osu! link parser are now floats instead of fixed two decimals.
- Automatic osu! link parsing now has three download buttons (standard beatmap, no vid, and bloodcat mirror),
    as well as the Max combo amount for that difficulty.
- Heavily refactored code in CommandHandler.cs
- Added in passrate to beatmap link parser
- Fixed a big oopsie woopsie uwu (File structure)

Version 1.7.0

- Level formula modified so that it's a little harder to level up
- Message cache size reduced to 100
- Fixed a bug with $scrapeserver that would cause the bot to freeze. This method is much more efficient, closes #27
- Created $scrapedatabase -- creates accounts for every member in every server that has less than 3500 members.
- Fixed a bug with the updated messages logger that caused embedded links to trigger the message updated log event.
- Added help command for $sttreflog
- $groll has been renamed to $roll (but keeps the alias of "gr")
- Command $osu added -- generates a profile for your osu! username with various statistics (also taps into osuset for added convenience).
- Fixed a bug with $osutop -- now requires number, then name. If name is blank, it defaults to the $osuset username.
- Tweaked $scrapedatabase
- Added $toggleannouncements command. This will toggle the level up announcements in chat.
- Automatic osu! beatmap link parsing functionality added!!
- Tillerino API key can now be added into config.json
- Level up announcements are now less intrusive

Version 1.6.0

- Kaguya got approved on Discordbots.org!! Give her an upvote here: https://discordbots.org/bot/538910393918160916
- $groll now takes points away on use, then gives them back + multiplier if the roll was won.
- $timelyreset now actually builds the embed. Same thing with $ctr
- Leveling embed is now more compact, takes up less space in chat.
- Added in ReliabilityService...if bot disconnects from websocket, it (should) reconnect on its own after 30 seconds.
- All log messages are now saved to a file (incase the bot crashes).
- Removed some unnecessary packages
- Timer added to restart application every 6 hours (to avoid disconnect issues).
- Added .gitignore.
- Changed Message cache from 1000 to 250 (to hopefully help wtih crashes)
- "viewfilter" is now an alias for "filterview"
- "$createrole" and "$deleterole" no longer require quotation marks when creating a role that has a space in the name. (Ex: Smelly Sushi)
- **Fixed a major bug with the word filter. If a message contains a filtered phrase, it will now be deleted properly. Resolves #23!**
- Took out the ability for the bot to log messages to it's own file (commandmessagelogs.txt). This will likely eliminate (potential) crashes.
    Kaguya would throw an unhandled exception if high rates of use were achieved.
- Fixed a bug with "$deleterole" where if multiple roles of the same name were found, the bot would not do anything.
    Now, Kaguya will delete all roles with the matched name.
- Updated "$DeleteTextChannel" and "$DeleteVoiceChannel" commands to properly delete the channels.
    Channels can now be mentioned (#<Channel>) or just the name of the channel will do.
- Fixed a bug with "$DeleteTextChannel" -- Kaguya would respond with a confirmation message for a successfully 
    deleted channel, even if the channel didn't exist in the first place.
- Fixed a small bug with "$unblacklist" where if the userAccount.Username property was `null`, it would be formatted weird.
    There are now two formats, one for if the username is null, and one for if the username isn't null (or empty).
- Added in some missing aliases in the help commands
- Fixed help command for "$groll" / "$gr"
- Added just more general fine-tuning to the list of help commands. ($h <cmd>)
- Commented out broken blackjack command, will uncomment it's finished.

Version 1.5.1

- High priority fix for crashes.


Version 1.5

- $filteradd [fa] added. Allows a server administrator to add words to a filter. If the word is typed in chat and is in the filter, the bot will automatically delete it.
    This applies for phrases including spaces as well.
- $filterremove [fr] added.
- $filterview [fv] added.
- $filterclear [clearfilter] added.
- $clear with no parameters now defaults to deleting 10 messages instead of 25.
- $setlogchannel / $log added. Sets the specified channel to be where the bot logs information.
- $resetlogchannel / $rlog added. Resets all log channels and disables logging (per log event -- $rlog all disables logging for the whole guild.)
- Updated $clear command so that it properly deletes the specified number of messages.
- New database file for cached server messages (this is required for proper logging).
- $awardeveryone / $awardall (new bot owner command).
- Fixed a bug with `$cmds utility` that prevented it from working.
- $g/$gamble has been renamed to $gr/$groll (all point gambling commands will start with g as of this patch.)
- $masspointsdistribute command added. This allows any user to evenly distribute all of their Kaguya points to everyone in the server.
    This, in turn, sets their own points to zero. What a generous act!
- Kaguya now sends a helpful message to the server owner upon joining a new guild.
- $massban now has a help command.
- Heavily cleaned up Misc.cs (huge file where all commands are). Now, 7 new classes are in existence, one for each module (Utility, Help, Fun, EXP, Currency, osu, and Administration.)
- $kaguyagtfo renamed to $kaguyaexit
- Modules and commands lists are now up to date.

Version 1.4.2.1
- Hotfix, files are now built/compiled properly. Definitely do not use any releases before this.

Version 1.4.2
- $timely now properly reads from commands.json. If commands.json is empty or doesn't exist, it will automatically be created as well.
- Updated modules/commands lists to be current.
- commands.json can now be edited almost exactly the same way as servers.json and accounts.json.


Version 1.4.1
- Implements a temporary fix for a bug that prevented $timely from working.


Version 1.4.0

- STAGEBOT HAS BEEN REBRANDED TO "Kaguya"!!!
- Added $rep command. Give your favorite person a rep point up to once per day!
- Added $scrapeserver command for bot owners. Generates accounts for every member of the server.
- $massblacklist will now ban any IGuildUser in the entire server regardless of whether they have typed in chat. Closes #17.
- Added in $profile command. Generates an image with a user's account information / statistics.
- Fixed a bug with $prefix where you could set a prefix greater than two characters. Closes #18
- Added in a bot response if a user types $recent or $osutop with no additional parameters, and has not set their osu name with $osuset.
- $serverexplb / $explb created, displays the top 10 users in the server in order of EXP.
- Same thing for the global leaderboard! ($globalexplb / $gexplb)
- Added in an $author command
- Added in $repauthor command

Version 1.3.0

- $delteams modified to take up less space when deleting large amounts of teams. 
    No longer embeds an individual message for each team deleted. (Credit to Ludeo)
- Fixed a bug where the bot would crash when using $removeallroles. Closes #13
- Fixed a bug where $osutop's title link would give 404 errors. Closes #10
- Tweaked $osutop to now have the chosen user's proper name instead of the name specified when executing the command.
    By this I mean the displayed username will have the same capitalization as what is shown on the official osu! website,
    instead of the capitalization chosen when executing the command. If someone's $osuset name has different capitalization
    than what is on the website, it won't matter anymore. Closes #8
- Fixed a bug where deleterole wouldn't do anything if two roles have the same name. 
    Bot now deletes the first role it finds with the specified name. Closes #14
- $clear/$c/$purge updated to default to deleting 25 messages if no other number is specified. Closes #12
- Tweaked $timely to pull from commands.json (in the case of timelyHours ever being edited, the bot will auto-update the timeout for timely)
- Tweaked $exp
- Bot owners no longer have to be an admin of the server they use $pointsadd in.
- Same thing for $expadd ^
- $expadd now has an alias of $addexp
- $pick & $echo now give error responses if they are missing parameters.
- Added help command for $prefix
- Added $prefix into Utility module.


Version 1.2.0
- Added database file for servers
- Fixed improper naming of help command (used for debugging)
- Added in $prefix, allowing servers to change the command prefix based on their preferences.
- When setting a new osu username with spaces (l i k e t h i s), the spaces are automatically replaced with underscores,
    allowing the user's osu stats to properly show.
- $massblacklist actually bans the targets now 

Version 1.1.2
- Fixed a bug with NC mod not showing properly in $osutop

Version 1.1.1
- HEAVILY refined the code for the osu! mods list.

Version 1.1.0

- Added accuracy table to code
- Added accuracy display to $osutop command
- Fixed timely command, you can now receive points at the proper time.
- Tuned exp to be given at a more precise time (once every 120 seconds of chatting)
- Bumped up the max amount of exp you can receive from a single message (from 10 to 11)
- osu! Beatmap difficulty names are now properly displayed in the $osutop command
- $osutop now defaults to 5 maps when a number is not specified. "$osutop player" is now possible and defaults to 5 maps.
- $mdls is now functional (was sent in help command but didn't actually work)
- $cmds now has an alias of $commands.
- $recent/$r is now implemented!
- $delteams is now working again, closes #3
- $osuset command Added
- Logging of Usernames is now in place in accounts.json (name#discrim format)
- $massblacklist command added
- Updated modules to reflect new commands
- $pointsadd can now add points to other users.
- $gamble/$g functionality now available, gamble those points!!
- Application will now properly restart after first time setup is completed.
- $kaguyagtfo command added. Forces Kaguya to leave the server this command was executed in.
- $h / $help command changed to display the list of commands, separated by category.

Version 1.0.1

- Fixed a bug with the EXP system. Resolves #2

Version 1.0.0

- First major release
- Adds fully functioning EXP system. Receive 7-10 exp every two minutes you send a message in chat!
- Replaced invite URL in help command
- Updated utility module to remove the "ChangeLog" command
- Created $level command
- Tweaked $h osutop command
- Tweaked $h createteamrole command
- Updated and fixed a bug in the $help command. Now instructs users on how to get to the command lists.
- Timely command is now fully functional
- "osuapikey" is now in config.json for self hosters. They can put their unique API key in for osu! related commands.

Version 0.10.2

- Updated formatting of ChangeLog.txt
- Added in letter grade display for all osu!Top plays
- Updated formatting of the osu!Top display message.
- Added in combo display for $osutop Misc.cs line 434: ([PlayerMaxCombo / MapMaxCombo])


Version 0.10.1

- Fixed bug where the improper profile picture would be displayed when using $osutop (Closes #1)
- Added in accuracy and pp display in $osutop


Version 0.10.0

- Added createteamrole command (ctr). Allows creation of a role and automatic assigning of said role to all mentioned users in one simple command.
- Added osutop command. Shows top <n> plays (up to 10) of a specific osu! player.
    (This command is really basic, better formatting will come in a later update.)
- Added delteams command. If the role name contains "Team: ", it will be deleted. 
- Added create role command (cr).
- Updated help command to match these new commands.


Version 0.9.1

- Changed version numbering scheme
- Removed changelog command.


Version 0.0.0.9:

- Removed {cmdPrefix} from all modules (it's a list of modules, not of commands).
- Introductory console message altered.
- Fixed broken ass clear command

Version 0.0.0.8:

- Added in "osuTournament" module. This module is designed to help with the management of osu! community tournaments.
- Added in createteamrole command. This allows anyone with the ManageRoles server permission to add an infinite amount of users to the same role.
    This is extremely ideal for osu!Tournament servers, making organizing participants very easy.
- If a user requests help on a command that doesn't exist, the bot now responds to this.
- Updated general help command
- Refined code using aliases for some commands
- clear can now be executed with "clear", "purge", and "c"
- kick and ban can now be executed with k and b respectively
- Added "deleterole" command. dr also executes this.
- Added "massban" command.
- Added "masskick" command.
- Added "changelog" command.
- Updated all command specific help commands to look more clean and consistent.


Version 0.0.0.7:

- Fixed wording issue with DeleteTextChannel command.
- Added in "fun" module
- Added in bot permission requirements for commands that require them (checking to make sure the bot has the permissions 
    it needs to execute a specific command).
- Added in "clear" command to delete messages in bulk
- New "purge" command does the same thing
- Fixed improper spacing with two help commands
- Added in a little documentation (for self hosters).
- System.Net.Http.HttpRequestException now handled (bot no longer crashes/throws an exception
    if a user doesn't have a [stable] internet connection.)
- Added in kick command
- Added in ban command
- Added removeallroles (rar) command


Version 0.0.0.6:

- Added in currency, utility, and 'fun' modules
- Added commands for said modules (cmds <module name>)
- Help and h commands are now usable without additional parameters, will result in a
    DM to the command user with helpful information
- Reorganized the code in Misc.cs -- Commands are "soft grouped" by their respective modules
    instead of having them be all over the place
- Removed some unnecessary commands/code
- If commands.json is not found, program will automatically create the file with 
    defaults of 500 points for timelyPoints and 24 hours for timelyHours (Used with timely command)
- Added many more command specific help commands.
- Permission requirement updated for CreateTextChannel and DeleteTextChannel:
    Old: Requires Administrator
    New: Only requires ManageChannels permission


Version 0.0.0.5: 

- First release of core structure to GitHub.